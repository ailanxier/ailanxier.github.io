<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png"><link rel="icon" href="/img/avatar.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Zeyu Dong"><meta name="keywords" content=""><meta name="description" content="刚开始入门学习全同态加密，这里对一些有关的数论知识进行整理，包括单位根，单位原根，分圆多项式等内容，供以后学习查阅，因为参考资料较杂，以及本人水平有限，可能存在较多错误，请予以指正"><meta property="og:type" content="article"><meta property="og:title" content="FHE学习笔记 #3 数论中的前置知识"><meta property="og:url" content="https://ailanxier.top/FHE-3-number%20theory"><meta property="og:site_name" content="Ailanxier"><meta property="og:description" content="刚开始入门学习全同态加密，这里对一些有关的数论知识进行整理，包括单位根，单位原根，分圆多项式等内容，供以后学习查阅，因为参考资料较杂，以及本人水平有限，可能存在较多错误，请予以指正"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://ailanxier.top/img/home/abstract_algebra.jpeg"><meta property="article:published_time" content="2022-11-04T14:07:26.000Z"><meta property="article:modified_time" content="2022-11-04T15:46:09.537Z"><meta property="article:author" content="Zeyu Dong"><meta property="article:tag" content="全同态加密"><meta property="article:tag" content="抽象代数"><meta property="article:tag" content="数论"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://ailanxier.top/img/home/abstract_algebra.jpeg"><title>FHE学习笔记 #3 数论中的前置知识 - Ailanxier</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/mac.css"><link rel="stylesheet" href="/js/iconfont.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"ailanxier.top",root:"/",version:"1.9.0",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:"§"},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"Vnw3P6XfzGV1nFXBCmueJQuN-gzGzoHsz",app_key:"ximSsc1aMmHfi7SNO8jMNm9F",server_url:"https://vnw3p6xf.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 6.0.0"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Ailanxier</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于我</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/bg/post.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="FHE学习笔记 #3 数论中的前置知识"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Zeyu Dong </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-11-04 22:07" pubdate>2022年11月4日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 6.1k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i>52 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-right:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="科研笔记" id="heading-c47ba403c8167b6df16c3813de69d4a8" role="tab" data-toggle="collapse" href="#collapse-c47ba403c8167b6df16c3813de69d4a8" aria-expanded="true">科研笔记 <span class="list-group-count">(3)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-c47ba403c8167b6df16c3813de69d4a8" role="tabpanel" aria-labelledby="heading-c47ba403c8167b6df16c3813de69d4a8"><div class="category-post-list"><a href="/FHE-1-abstract%20algebra" title="FHE学习笔记 #1 部分抽象代数名词" class="list-group-item list-group-item-action"><span class="category-post">FHE学习笔记 #1 部分抽象代数名词</span> </a><a href="/FHE-2-polynomial%20ring" title="FHE学习笔记 #2 多项式环" class="list-group-item list-group-item-action"><span class="category-post">FHE学习笔记 #2 多项式环</span> </a><a href="/FHE-3-number%20theory" title="FHE学习笔记 #3 数论中的前置知识" class="list-group-item list-group-item-action active"><span class="category-post">FHE学习笔记 #3 数论中的前置知识</span></a></div></div></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">FHE学习笔记 #3 数论中的前置知识</h1><p class="note note-info">本文最后更新于：2022年11月4日 晚上</p><div class="markdown-body"><div class="note note-success"><p><strong>文章使用 wolai 编写并导出，在 <a target="_blank" rel="noopener" href="https://www.wolai.com/ailanxier/HsPYRbMMzMNPJsuX97SNy">wolai</a> 中观看效果更好，有颜色高亮和实时更新</strong></p></div><h3 id="不可约多项式-Irreducible-Polynomial"><a href="#不可约多项式-Irreducible-Polynomial" class="headerlink" title="不可约多项式 Irreducible Polynomial"></a>不可约多项式 Irreducible Polynomial</h3><blockquote><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Irreducible_polynomial" title="Irreducible polynomial - Wikipedia">Irreducible polynomial - Wikipedia</a></p></blockquote><p>定义比较多，通俗来说，不可约多项式首先是「非常数多项式 Non-constant Polynomial」，且不能被分解成两个「非常数多项式」乘积的形式。</p><blockquote><p>如果能分解为仅含常数项的多项式，那用单位元 $\bf 1$ 就能无限分解了，显然不合理。</p></blockquote><p>更严格的定义是要说明在什么域上是不可约的，例如 $x^2-2$ 在整数域上是不可约的，因为它不能分解成系数为整数的非常数多项式。但是 $x^2-2$ 在实数域上属于可约多项式，可以分解为 $(x-\sqrt 2)(x-\sqrt 2)$。</p><h3 id="单位根-Root-of-Unity"><a href="#单位根-Root-of-Unity" class="headerlink" title="单位根 Root of Unity"></a>单位根 <strong>Root of Unity</strong></h3><blockquote><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Root_of_unity#General_definition" title="Root of unity - Wikipedia">Root of unity - Wikipedia</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhouchangyu1221/article/details/104729987/" title="n 次单位根的求法_cyzhou1221的博客-CSDN博客_n次单位根">n 次单位根的求法_cyzhou1221的博客-CSDN博客_n次单位根</a></p><p>极其推荐阅读 🔥： <a target="_blank" rel="noopener" href="https://yhx-12243.github.io/OI-transit/memos/17.html" title="分圆多项式 (yhx-12243.github.io)">分圆多项式 (yhx-12243.github.io)</a>，前置知识有详细讲述单位根和本原单位根的内容，需要科学上网</p></blockquote><p>在复数域上，$n$ 次单位根是指方程 $z^n=1$ 的解，$n$ 为正整数，且在复数域内有且只有 $n$ 个解。解的形式为</p><script type="math/tex;mode=display">z_k=e^{\frac{2\pi i}{n}k}=\exp\left(\frac{2\pi i}{n}k\right),k\in\mathbb{Z}</script><blockquote><p>证明：</p><p>复数的形式为 $z=R\exp(i\theta)=R\cos\theta+iRsin\theta,R&gt;0$</p><p>两个复数 $z_1,z_2$ 相等 $\iff~~R_1=R_2,\theta_1=\theta_2+2k\pi,k\in \mathbb{Z}$</p><p>而复数 $1=1\exp(i0),\text{i.e.}\;R=1,\theta=0$，代入 $z^n=1$ 得到：</p><script type="math/tex;mode=display">R^n=1,n\theta=2k\pi+0,R\ge0,k\in \mathbb{Z}</script><p>解得 $\begin{aligned}R=1,\theta=\frac{2k\pi}{n}\end{aligned},k\in\mathbb{Z}$，则 $\begin{aligned}<br>z_k=\exp\left(\frac{2\pi i}{n}k\right),<br>k\in\mathbb{Z}<br>\end{aligned}$</p></blockquote><p>实际上，只有 $k=0,1,\cdots,n-1$ 共 $n$ 个不重根，也就是说，在复数域上对 1 开 $n$ 次方根的结果有 $n$ 个。</p><p>设 $ \begin{aligned}<br>z=\exp\left(\frac{2\pi i}{m}\right)<br>\end{aligned} $，则这 $n$ 个根为 $z^0=1,z,z^2,\ldots,z^{n-1}$。</p><blockquote><p>证明：</p><p>取 $k=n+s,s\in\mathbb{Z}$，则</p><script type="math/tex;mode=display">\begin{aligned}
z_k=\exp\left(\frac{2\pi i}{n}k\right)&=\exp\left(\frac{2\pi i}{n}(n+s)\right)=\exp\left(2\pi i+\frac{2\pi i}{n}s\right)
\\&=\exp\left(2\pi i\right)\times\exp\left(\frac{2\pi i}{n}s\right)=(e^{\pi i})^2\times\exp\left(\frac{2\pi i}{n}s\right)
\\&=1\times\exp\left(\frac{2\pi i}{n}s\right)=z_s
\end{aligned}</script><p>这里使用了<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%AC%A7%E6%8B%89%E5%85%AC%E5%BC%8F" title="欧拉公式">欧拉公式</a> $e^{\pi i}+1=0$。</p><p>可以看出当 $k,s$ 属于同一<a target="_blank" rel="noopener" href="https://www.wolai.com/ailanxier/wBn2PmNvMx2BM8yeM7tgr9#7kfiGq9vzREqm6B9vzYVZT" title="同余类">同余类</a>（模 $n$）时，这两个根是相同的，所以不重根的数目和模 $n$ <a target="_blank" rel="noopener" href="https://www.wolai.com/ailanxier/wBn2PmNvMx2BM8yeM7tgr9#kJqSgTBg4erbMh96xiJusu" title="最小剩余系">最小剩余系</a>大小相同，即 $n$。</p></blockquote><p>一些性质：</p><ul><li><p>对于任意 $n$，当 $k=0$ 时，$z_k=1$</p></li><li><p>$n$ 次单位根的模为 1，在复平面 Complex plane 上等分单位圆，如下图是 $n=5$ 次单位根在复平面上的分布</p><div align="center"><img src="../img/blog/num-note-images/One5Root.svg" srcset="/img/loading.gif" lazyload></div></li><li><p>$n$ 次单位根的任意次幂仍为 $n$ 次单位根</p><blockquote><p>证明：</p><p>设 $z$ 是 $n$ 次单位根，则对于 $k\in\mathbb{Z}$，有</p><script type="math/tex;mode=display">(z^k)^n=(z^n)^k=1^k=1</script></blockquote></li><li><p>同理可以证出，任意两个 $n$ 次单位根的乘积仍然是 $n$ 次单位根</p></li><li><p>由上述性质，可以得到所有 $n$ 次单位根可以构成一个乘法交换循环群</p></li><li><p>利用 $n$ 个根对 $x^n-1$ 进行多项式分解</p><p>由 Vieta 定理可以得到：</p><script type="math/tex;mode=display">z=\exp\left(\frac{2\pi i}{m}\right)，x^n-1=(x-1)(x-z)\cdots(x-z^{n-1})</script><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Vieta's_formulas#Proof" title="Vieta's formulas - Wikipedia">Vieta’s formulas - Wikipedia</a></p></li></ul><h3 id="单位原根-Primitive-Roots-of-Unity"><a href="#单位原根-Primitive-Roots-of-Unity" class="headerlink" title="单位原根 Primitive Roots of Unity"></a>单位原根 Primitive Roots of Unity</h3><p>$n$ 次单位原根是指 $n$ 次单位根中的某些根 $z$，满足 $\forall m\in\{1,2,\ldots,n-1\},z^m\not=0,z^n=1$。</p><p>$n$ 次单位根 $z_k$ 满足 $\gcd(n,k)=1$ $\iff$ $n$ 次单位原根。</p><blockquote><p>自己瞎证明的 🥺：</p><ul><li><p>$\gcd(n,k)=1$ 说明 $z_k$ 就是 $n$ 次单位原根</p><p>设 $\forall k\in\{k|\gcd(n,k)=1\}$，$ \begin{aligned}<br>z_k=\exp\left(\frac{2k\pi i}{n}\right)<br>\end{aligned} $ ，则</p><script type="math/tex;mode=display">\begin{aligned}
\exists d \in\mathbb{N^+}\text{~s.t.~} z_k^d=\exp\left(\frac{2kd\pi i}{n}\right)=1
\end{aligned}</script><p>由 $\exp(i\theta)=\cos\theta+i\sin\theta$ 展开得到</p><script type="math/tex;mode=display">\exp\left(i\frac{2kd\pi }{n}\right)=\cos\left(\frac{2kd\pi }{n}\right)+i\sin\left(\frac{2kd\pi }{n}\right)</script><p>则 $ \begin{aligned}<br>\frac{2kd\pi }{n}=2k’\pi,k’\in\mathbb{Z}<br>\end{aligned} $，这样 $ \begin{aligned}<br>\cos\frac{2kd\pi }{n}<br>\end{aligned} $ 才会等于 1，</p><p>化简得到 $kd=k’n,k’\in\mathbb Z$，即 $n\mid kd$，</p><p>又因为 $\gcd(n,k)=1$，所以 $n\mid d$，也就是说 $n\le d$，所以 $n$ 就是使 $z_k^d=1$ 成立的最小正数 $d$，满足 $n$ 次单位原根的定义。</p></li><li><p>$n$ 次单位原根都满足 $\gcd(n,k)=1$</p><p>首先 $k=0$ 时一定不是 $n$ 次单位原根，因为本身就是 1，同时也不满足 $\gcd(n,k)=1$。</p><p>假设 $z_k,1\le k&lt;n$ 是 $n$ 次单位原根，记 $\gcd(n,k)=d,1\le d&lt;n,n=n’d,k=k’d,n’\in \mathbb{Z},k’ \in \mathbb Z$，那么有</p><script type="math/tex;mode=display">z_k^{n'}=\exp\left(\frac{2kn'\pi i}{n}\right)=\exp\left(\frac{2\pi i}{n}\times\frac{kn}{d}\right)=\exp\left(2\pi i k'\right)=1</script><p>如果 $d\not=1$，则有 $n’&lt;n$，这就不满足 $z_k$ 是 $n$ 次单位原根的前提，得到矛盾，所以 $d=1$，即 $\gcd(n,k)=1$。</p></li></ul></blockquote><p>性质：</p><ul><li><p>若 $n$ 是质数，对于 $k=\{1,2,\ldots,n-1\}$ 的 $z_k$ 都是 $n$ 次单位原根</p></li><li><p>若 $z$ 为 $n$ 次单位原根，则 $z^0,z^1,z^2,\ldots,z^{n-1}$是互异的 $n$ 次单位根，即生成了整个 $n$ 次单位根循环群，$z$ 是生成元</p><blockquote><p>证明：</p><p>首先由 $n$ 次单位根的性质可知 $z$ 的任意次幂都是 $n$ 次单位根。</p><p>假设存在 $z^a=z^b,0\le a&lt;b\le n-1$，那么 $z^{b-a}=1,0&lt;b-a\le n-1$，这就与原根的定义矛盾，所以这些次幂都是互异的。</p></blockquote></li></ul><h3 id="分圆多项式-Cyclotomic-Polynomial"><a href="#分圆多项式-Cyclotomic-Polynomial" class="headerlink" title="分圆多项式 Cyclotomic Polynomial"></a>分圆多项式 Cyclotomic Polynomial</h3><blockquote><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Cyclotomic_polynomial" title="Cyclotomic polynomial - Wikipedia">Cyclotomic polynomial - Wikipedia</a></p><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1kz4y1X7HN/?spm_id_from=333.880.my_history.page.click\&amp;vd_source=ef1448cd7cb97cff903c2e66c975ba5d" title="数论讲义下 多项式 2 分圆多项式_哔哩哔哩_bilibili">数论讲义下 多项式 2 分圆多项式_哔哩哔哩_bilibili</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/105400582" title="分圆多项式的简单性质与应用 - 知乎 (zhihu.com)">分圆多项式的简单性质与应用 - 知乎 (zhihu.com)</a></p><p>极其推荐阅读 🔥： <a target="_blank" rel="noopener" href="https://yhx-12243.github.io/OI-transit/memos/17.html" title="分圆多项式 (yhx-12243.github.io)">分圆多项式 (yhx-12243.github.io)</a></p></blockquote><p>$n$ 次分圆多项式是 $x^n-1$ 的因式，具有以下特点：</p><ul><li><p>具有整数系数</p></li><li><p>是唯一且不可约的</p></li><li><p>首一多项式</p></li><li><p>不是任何 $x^k-1,k&lt;n$ 的因式</p></li><li><p>是实数域上 $n$ 次单位根的<a target="_blank" rel="noopener" href="https://www.wolai.com/ailanxier/fEPneu1wsCBBd29R8mqhdi#pRyNcv7sZATcm4N8jpxFKm" title="极小多项式">极小多项式</a></p></li></ul><p>从最后一点可以看出，$n$ 次分圆多项式与 $n$ 次单位原根有着紧密的关系，实际上，$n$ 次分圆多项式的形式就是 $n$ 次单位原根为单根的首一多项式的乘积：</p><script type="math/tex;mode=display">\Phi_{n}(x)=\prod_{\substack{1 \leq k \leq n \\ \operatorname{gcd}(k, n)=1}}\left(x-e^{2 i \pi \frac{k}{n}}\right)</script><blockquote><p>由于 $n$ 次单位原根一共有 $\varphi(n)$ 个，所以 $n$ 次分圆多项式的次数为 $\text{deg}\,\Phi_n(x)=\varphi(n)$，大概也就是分圆多项式使用 $\Phi$ 的原因吧。</p><p>这里上下界划到了 $[1,n]$，其实是和 $[0,n-1]$ 模 $n$ 等价的，但是不能对 $0$ 进行 $\gcd$ 运算，所以后面都用 $[1,n]$。</p></blockquote><p>$n$ 次分圆多项式具有许多奇妙的特性：</p><ul><li><p>$ \begin{aligned}<br>\prod_{d\mid n}\Phi_d(x)=x^n-1<br>\end{aligned} $</p><blockquote><p>首先讲一个引理 $\begin{aligned}<br>\sum_{d\mid n}\varphi(d)=n\end{aligned}$ 及其证明，类似这个证明可以证出上述特性。</p><p>证明：</p><p>如果 $\gcd(k,n)=d,k&lt;n$，那么就有 $ \begin{aligned}<br>\gcd\left(\frac{k}{d},\frac{n}{d}\right)=1<br>\end{aligned} $。</p><p>如果我们要统计 $1\sim n$ 的整数中，满足 $\gcd(k,n)=d$ 的 $k$ 的个数，记为 $f(d)$。</p><p>让我们试着考虑一下小于 $\begin{aligned}\frac{n}{d}\end{aligned}$ 的整数中，与 $\begin{aligned}\frac{n}{d}\end{aligned}$ 互质的数 $k’$，会发现他们乘上 $d$ 后，满足 $\gcd(k’d,n)=d$。</p><p>所以有 $\begin{aligned}f(d)=\varphi\left(\frac{n}{d}\right)\end{aligned}$。</p><p>又因为 $n$ 和 $1\sim n$ 中每个整数的 $\gcd$ 都是 $n$ 的因子，所以有 $\begin{aligned}\sum_{d=1}^nf(d)=\sum_{d\mid n}f(d)=n\end{aligned}$，</p><p>进而得到 $\begin{aligned}\sum_{d\mid n}\varphi\left(\frac{n}{d}\right)=n\end{aligned}$，由于因子 $d$ 和 $\begin{aligned}\frac{n}{d}\end{aligned}$ 具有对称性，所以 $\begin{aligned}\sum_{d\mid n}\varphi(d)=n\end{aligned}$。</p></blockquote><p>类似上面的证明思路，先设 $ \begin{aligned}\omega_n^k=\exp\left(\frac{2k\pi i}{n}\right),k\in\{0,1,\ldots,n-1\}<br>\end{aligned} $ 为一个 $n$ 次单位根，记 $\gcd(n,k)=d,n=n’d,k=k’d,\gcd(n’,k’)=1,n’&gt;k’$。</p><p>此时我们会发现，$w_{n’}^{k’}$ 不就是 $n’$ 次单位原根吗，因为它满足了 $\gcd(n’,k’)=1$，注意到 $n’\mid n$，即它也是 $n$ 的因子。</p><p>进一步会发现，$w_{n’}^{k’}$ 是个 $n$ 次单位根，因为有</p><script type="math/tex;mode=display">\begin{aligned}
\omega_{n'}^{k'}=\exp\left(\frac{2k'\pi i}{n'}\right)=\exp\left(\frac{2k'\pi i\times\frac{n}{n'}}{n'\times\frac{n}{n'}}\right)
=\exp\left(\frac{2k'd\pi i}{n}\right)
=\exp\left(\frac{2k\pi i}{n}\right)
=w_n^k
\end{aligned}</script><p>又绕回来了，显然可以看出每个 $n$ 的因子 $n’$ 的单位原根，都和 $n$ 次单位根有着一一对应的关系。</p><blockquote><p>对于一个 $n$ 次单位根 $w_n^k$，每个 $k$ 确定了一个因子 $n’$ 和其对应的 $w_{n’}^{k’}$ 单位原根。</p></blockquote><p>又因为我们上面有 $x^n-1$ 的因式分解形式为</p><script type="math/tex;mode=display">x^n-1=(x-1)(x-w_n^1)\cdots(x-w_n^{n-1})</script><p>还有 $n’$ 的分圆多项式形式</p><script type="math/tex;mode=display">\Phi_{n'}(x)=\prod_{\substack{1 \leq k' \leq n' \\ \operatorname{gcd}(k', n')=1}}\left(x-w_{n'}^{k'}\right)</script><p>根据一一对应关系，逐一代替为 $ n’ $ 次单位原根就能得到 $ \begin{aligned}<br>\prod_{d\mid n}\Phi_d(x)=x^n-1<br>\end{aligned} $。</p></li><li><p>当 $n$ 为质数时，有：</p><script type="math/tex;mode=display">\Phi_{n}(x)=\frac{x^{n}-1}{x-1}=x^{n-1}+x^{n-2}+\cdots+1</script><blockquote><p>证明：</p><p>首先有个因式分解的奇技淫巧：</p><script type="math/tex;mode=display">x^{n}-1=(x-1)\left(x^{n-1}+x^{n-2}+\cdots+x+1\right)</script><p>把右边乘进去就会发现中间次数项都被巧妙地消掉了，只剩 $n$ 次方项和 1。</p><p>然后由第一个分圆多项式的性质，可以知道当 $n$ 为质数时，因子只有 1 和它本身，有</p><script type="math/tex;mode=display">\begin{aligned}
\prod_{d\mid n}\Phi_d(x)=\Phi_1(x)\Phi_n(x)=(x-w_1^1)\Phi_n(x)=(x-1)\Phi_n(x)=x^n-1
\end{aligned}</script><p>移项后再代入上述因式分解中即可得到 $ \begin{aligned}<br>\Phi_{n}(x)=\frac{x^{n}-1}{x-1}=x^{n-1}+x^{n-2}+\cdots+1<br>\end{aligned} $</p></blockquote></li><li><p>对于任意正整数 $n$，$\Phi_{n}(x)$ 是整数多项式环 $\mathbb{Z}[x]$ 中的不可约多项式</p></li><li><p>$\Phi_{2^{d}}(x)=x^{2^{d-1}}+1$</p></li></ul></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E7%A7%91%E7%A0%94%E7%AC%94%E8%AE%B0/" class="category-chain-item">科研笔记</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E5%85%A8%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86/">#全同态加密</a> <a href="/tags/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0/">#抽象代数</a> <a href="/tags/%E6%95%B0%E8%AE%BA/">#数论</a></div></div><div class="license-box my-3"><div class="license-title"><div>FHE学习笔记 #3 数论中的前置知识</div><div>https://ailanxier.top/FHE-3-number theory</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Zeyu Dong</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2022年11月4日</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"></article><article class="post-next col-6"><a href="/FHE-2-polynomial%20ring" title="FHE学习笔记 #2 多项式环"><span class="hidden-mobile">FHE学习笔记 #2 多项式环</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",function(){var i=Object.assign({appId:"RPMS8nldJp0JoyyYWovwKE7g-gzGzoHsz",appKey:"XyHCoNwPhJnfnVvl8QA63j3L",path:"window.location.pathname",placeholder:null,avatar:"retro",meta:["nick","mail","link"],requiredFields:[],pageSize:10,lang:"zh-CN",highlight:!1,recordIP:!1,serverURLs:"",emojiCDN:null,emojiMaps:null,enableQQ:!1},{el:"#valine",path:window.location.pathname});new Valine(i),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var i="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><script>Fluid.utils.createScript("https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js",function(){mermaid.initialize({theme:"default"})})</script><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="leancloud-site-pv-container" style="display:none">总访问量 <span id="leancloud-site-pv"></span> 次 </span><span id="leancloud-site-uv-container" style="display:none">总访客数 <span id="leancloud-site-uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-t}),0<o.find(".toc-list-item").length&&o.css("visibility","visible"))})</script><script>!function(){var n,i=CONFIG.code_language.enable&&CONFIG.code_language.default,t=CONFIG.copy_btn;(i||t)&&(n="",n+='<div class="code-widget">',n+="LANG",n+="</div>",jQuery(".markdown-body pre").each(function(){var e,a=jQuery(this);0<a.find("code.mermaid").length||0<a.find("span.line").length||(e="",i&&(e=CONFIG.code_language.default,0<a[0].children.length&&2<=a[0].children[0].classList.length&&a.children().hasClass("hljs")?e=a[0].children[0].classList[1]:a[0].getAttribute("data-language")?e=a[0].getAttribute("data-language"):a.parent().hasClass("sourceCode")&&0<a[0].children.length&&2<=a[0].children[0].classList.length?(e=a[0].children[0].classList[1],a.parent().addClass("code-wrapper")):a.parent().hasClass("markdown-body")&&0===a[0].classList.length&&a.wrap('<div class="code-wrapper"></div>'),e=e.toUpperCase().replace("NONE",CONFIG.code_language.default)),a.append(n.replace("LANG",e).replace('code-widget">',(a=a[0],(0<=Fluid.utils.getBackgroundLightness(a)?"code-widget-light":"code-widget-dark")+(t?' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>':' code-widget">')))),t&&Fluid.utils.createScript("https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js",function(){new window.ClipboardJS(".copy-btn",{target:function(e){for(var a=e.parentNode.childNodes,n=0;n<a.length;n++)if("CODE"===a[n].tagName)return a[n]}}).on("success",function(e){e.clearSelection(),e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-copy","icon-success"),setTimeout(function(){e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-success","icon-copy")},2e3)})}))}))}()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o,n=[];for(o of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))n.push(".markdown-body > "+o.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script>MathJax={tex:{inlineMath:{"[+]":[["$","$"]]}},loader:{load:["ui/lazy"]},options:{renderActions:{findScript:[10,n=>{document.querySelectorAll('script[type^="math/tex"]').forEach(e=>{var t=!!e.type.match(/; *mode=display/);const a=new n.options.MathItem(e.textContent,n.inputJax[0],t);t=document.createTextNode("");e.parentNode.replaceChild(t,e),a.start={node:t,delim:"",n:0},a.end={node:t,delim:"",n:0},n.math.push(a)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}}</script><script src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-svg-full.js"></script><script src="/js/local-search.js"></script><script defer src="/js/leancloud.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [ ["$","$"], ["\\(","\\)"] ], skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'], processEscapes: true } }); MathJax.Hub.Queue(function() { var all = MathJax.Hub.getAllJax(); for (var i = 0;
    i
    < all.length; ++i) all[i].SourceElement().parentNode.className +=' has-jax' ; });</script><script id="MathJax-script" async src="https://lib.baomitu.com/npm/mathjax@3/es5/tex-svg-full.js"></script></body></html>